---
import { getCollection, getEntry } from "astro:content"
import Layout from "../../layouts/Layout.astro"

export async function getStaticPaths() {
  const posts = await getCollection("posts")

  return posts.map(({ slug, data }) => {
    return {
      params: { slug },
      props: { title: data.title },
    }
  })
}

const { slug } = Astro.params
const { title } = Astro.props

const entry = await getEntry("posts", slug)
const { Content, headings } = await entry.render()
---

<Layout classes={["flex justify-between container mx-auto xl:max-w-screen-xl"]}>
  <article class="prose prose-invert w-[920px] flex-none">
    <h1>{title}</h1>
    <Content />
  </article>
  <aside class="w-[320px] flex-none">
    <ul>
      {
        headings.map((item, idx) => {
          return (
            <li>
              {item.text}-{item.depth}-{item.slug}
            </li>
          )
        })
      }
    </ul>
  </aside>
</Layout>
